<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LIFF è‡ªå‹•ç™¼é€é—œéµå­—</title>
    <script src="https://static.line-scdn.net/liff/edge/2.1/sdk.js"></script>
</head>
<body>
    <h1>ğŸš© æ­£åœ¨è‡ªå‹•ç™¼é€ï¼Œè«‹ç¨å€™...</h1>

    <script>
        window.onload = async function () {
            try {
                // åˆå§‹åŒ– LIFF
                await liff.init({ liffId: "2007116810-r5MJRQ1j" });

                // ç¢ºèªæ˜¯å¦åœ¨ LINE App å…§
                if (!liff.isInClient()) {
                    alert("âš  è«‹ç”¨ LINE APP æƒ NFCï¼Œå¦å‰‡ç„¡æ³•è‡ªå‹•ç™¼é€");
                    return;
                }

                // è§£æ URL keyword
                const urlParams = new URLSearchParams(window.location.search);
                const keyword = urlParams.get('keyword');

                if (!keyword) {
                    alert("âš  URL ç¼ºå°‘ keyword åƒæ•¸");
                    return;
                }

                // é©—è­‰å¯ç”¨çš„é—œéµå­—
                const validKeywords = [
                    '1-1', '1-2', '1-3', '2-1', '2-2', '2-3',
                    '03', '05', '06', '7-1', '7-2', '8-1', '8-2',
                    '9-1', '9-2', '10-1', '10-2', '11-1', '11-2',
                    '12-1', '12-2', '13-1', '13-2', '15', '16',
                    '17', '18-1', '18-2', '18-3', '19-1', '19-2',
                    '19-3', '20'
                ];

                if (!validKeywords.includes(keyword)) {
                    alert("âŒ ç„¡æ•ˆçš„ keywordï¼š" + keyword);
                    return;
                }

                // ç™¼é€é—œéµå­—åˆ°èŠå¤©å®¤
                await liff.sendMessages([{
                    type: 'text',
                    text: keyword
                }]);

                alert("âœ… å·²è‡ªå‹•ç™¼é€ï¼š" + keyword);
                liff.closeWindow(); // è‡ªå‹•é—œé–‰ LIFF

            } catch (error) {
                console.error("ç™¼é€å¤±æ•—: ", error);
                alert("âŒ ç™¼é€å¤±æ•—ï¼Œè«‹æª¢æŸ¥ LIFF è¨­å®š");
            }
        }
    </script>
</body>
</html>
